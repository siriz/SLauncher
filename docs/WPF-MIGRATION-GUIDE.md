# WinUI 3 → WPF 마이그레이션 가이드

## ?? 개요
SLauncher를 WinUI 3에서 WPF로 전환하여 경량화 목표 달성

**목표 용량:**
- Framework-Dependent: 5-15MB (현재 WinUI 3: 10-30MB)
- Self-Contained: 60-80MB (현재 WinUI 3: 180-250MB)

---

## ?? Phase 1: 프로젝트 구조 설정 ?

### 1.1 새 WPF 프로젝트 생성 완료
```
? SLauncher.WPF 프로젝트 생성됨
```

### 1.2 프로젝트 파일 설정

`SLauncher.WPF/SLauncher.WPF.csproj` 수정:

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net8.0-windows</TargetFramework>
    <UseWPF>true</UseWPF>
    <ApplicationIcon>Resources\icon.ico</ApplicationIcon>
    <AssemblyName>SLauncher</AssemblyName>
    <RootNamespace>SLauncher</RootNamespace>
    <AssemblyVersion>2.1.2.0</AssemblyVersion>
    <FileVersion>2.1.2.0</FileVersion>
    <Version>2.1.2.0</Version>
    <Description>SLauncher - Modern app launcher for Windows (WPF Edition)</Description>
    <Copyright>Generated by ZXE</Copyright>
    <AllowUnsafeBlocks>True</AllowUnsafeBlocks>
    <Platforms>x64</Platforms>
    
    <!-- 경량화 설정 -->
    <SelfContained>false</SelfContained>
    <DebugType>none</DebugType>
    <DebugSymbols>false</DebugSymbols>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)'=='Release'">
    <Optimize>True</Optimize>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="System.Text.Json" Version="9.0.0" />
  </ItemGroup>

  <ItemGroup>
    <Resource Include="Resources\**\*" />
  </ItemGroup>
</Project>
```

---

## ?? Phase 2: 폴더 구조 생성

### 2.1 필요한 폴더 생성
```cmd
cd SLauncher.WPF
mkdir Classes
mkdir Controls
mkdir Resources
mkdir Controls\Dialogs
mkdir Controls\GridViewItems
```

---

## ?? Phase 3: 클래스 파일 복사 (Shell32.cs 등)

### 3.1 복사할 파일 목록

**Classes 폴더:**
- `Shell32.cs` - Win32 API 래퍼 (100% 재사용 가능)
- `IconHelpers.cs` - 아이콘 헬퍼 (일부 수정 필요)
- `UserSettingsClass.cs` - 설정 관리 (거의 그대로)
- `UIFunctionsClass.cs` - UI 헬퍼 (WPF용 수정 필요)
- `MultiFileSystemWatcher.cs` - 파일 감시자 (그대로)

### 3.2 복사 명령
```cmd
:: Classes 폴더
copy ..\SLauncher\Classes\Shell32.cs Classes\
copy ..\SLauncher\Classes\IconHelpers.cs Classes\
copy ..\SLauncher\Classes\UserSettingsClass.cs Classes\
copy ..\SLauncher\Classes\UIFunctionsClass.cs Classes\
copy ..\SLauncher\Classes\MultiFileSystemWatcher.cs Classes\

:: Resources
xcopy /E /I ..\SLauncher\Resources Resources
```

---

## ?? Phase 4: XAML 변환 가이드

### 4.1 네임스페이스 변경

**WinUI 3:**
```xml
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:winex="using:WinUIEx"
xmlns:wct="using:CommunityToolkit.WinUI.Controls"
```

**WPF:**
```xml
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="clr-namespace:SLauncher"
```

### 4.2 컨트롤 매핑

| WinUI 3 | WPF |
|---------|-----|
| `InfoBar` | `Border` + `TextBlock` (커스텀) |
| `NavigationView` | `Menu` 또는 `TabControl` |
| `SettingsCard` | `GroupBox` 또는 커스텀 UserControl |
| `ContentDialog` | `Window` (DialogResult 사용) |
| `TeachingTip` | `Popup` + `Border` |
| `GridView` | `ListView` + `WrapPanel` |

### 4.3 스타일 변경

**WinUI 3:**
```xml
<Button Style="{ThemeResource AccentButtonStyle}" />
```

**WPF:**
```xml
<Button Style="{StaticResource AccentButtonStyle}" />
<!-- 또는 커스텀 스타일 정의 -->
```

---

## ?? Phase 5: MainWindow.xaml 변환

### 5.1 WinUI 3 MainWindow.xaml → WPF

**주요 변경사항:**
1. `WindowEx` → `Window`
2. `Grid` 구조는 유지
3. `InfoBar` → 커스텀 컨트롤로 대체
4. `GridView` → `ListView` with `WrapPanel`

### 5.2 예시

**WinUI 3:**
```xml
<winex:WindowEx>
    <Grid>
      <InfoBar x:Name="UpdateInfoBar" />
      <GridView x:Name="ItemsGridView" />
    </Grid>
</winex:WindowEx>
```

**WPF:**
```xml
<Window>
    <Grid>
        <Border x:Name="UpdateInfoBar" Visibility="Collapsed">
    <TextBlock Text="Update available" />
        </Border>
     <ListView x:Name="ItemsListView">
            <ListView.ItemsPanel>
           <ItemsPanelTemplate>
            <WrapPanel />
  </ItemsPanelTemplate>
        </ListView.ItemsPanel>
        </ListView>
    </Grid>
</Window>
```

---

## ?? Phase 6: 코드-비하인드 수정

### 6.1 네임스페이스 변경

**WinUI 3:**
```csharp
using Microsoft.UI.Xaml;
using Microsoft.UI.Xaml.Controls;
using WinUIEx;
```

**WPF:**
```csharp
using System.Windows;
using System.Windows.Controls;
```

### 6.2 주요 API 변경

| WinUI 3 | WPF |
|---------|-----|
| `XamlRoot` | 제거 (불필요) |
| `DispatcherQueue.EnqueueAsync()` | `Dispatcher.Invoke()` |
| `ContentDialog.ShowAsync()` | `Window.ShowDialog()` |
| `StorageFile` | `System.IO.File` |

### 6.3 예시

**WinUI 3:**
```csharp
await DispatcherQueue.EnqueueAsync(() => {
    // UI 업데이트
});
```

**WPF:**
```csharp
Dispatcher.Invoke(() => {
    // UI 업데이트
});
```

---

## ?? Phase 7: 컨트롤 생성

### 7.1 GridViewTile → WPF UserControl

**새로 생성할 파일:**
- `Controls/GridViewItems/GridViewTile.xaml`
- `Controls/GridViewItems/GridViewTileGroup.xaml`

**변경사항:**
- `UserControl` 기반 유지
- 드래그 앤 드롭 API 변경
- 우클릭 메뉴: `MenuFlyout` → `ContextMenu`

---

## ?? Phase 8: 다이얼로그 변환

### 8.1 ContentDialog → Window

**WinUI 3 AddFileDialog:**
```csharp
public sealed partial class AddFileDialog : ContentDialog
{
  // ...
}

// 사용
var dialog = new AddFileDialog { XamlRoot = this.XamlRoot };
await dialog.ShowAsync();
```

**WPF AddFileDialog:**
```csharp
public partial class AddFileDialog : Window
{
    public bool? DialogResult { get; set; }
    // ...
}

// 사용
var dialog = new AddFileDialog { Owner = this };
bool? result = dialog.ShowDialog();
```

---

## ?? Phase 9: 리소스 및 아이콘

### 9.1 리소스 복사
```cmd
xcopy /E /I ..\SLauncher\Resources SLauncher.WPF\Resources
```

### 9.2 App.xaml 리소스 딕셔너리 설정
```xml
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
 <!-- 스타일 -->
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources>
```

---

## ?? Phase 10: 빌드 및 테스트

### 10.1 빌드 명령
```cmd
cd SLauncher.WPF
dotnet build -c Release
```

### 10.2 Publish 명령
```cmd
dotnet publish -c Release -r win-x64 --self-contained false
```

### 10.3 예상 결과
```
?? Framework-Dependent: 5-15MB
?? Self-Contained: 60-80MB
```

---

## ?? 마이그레이션 체크리스트

- [ ] Phase 1: 프로젝트 구조 설정 ?
- [ ] Phase 2: 폴더 구조 생성
- [ ] Phase 3: 클래스 파일 복사
- [ ] Phase 4: Shell32.cs 테스트
- [ ] Phase 5: IconHelpers.cs WPF 버전 작성
- [ ] Phase 6: MainWindow.xaml 변환
- [ ] Phase 7: MainWindow.xaml.cs 변환
- [ ] Phase 8: GridViewTile 컨트롤 생성
- [ ] Phase 9: SettingsWindow 변환
- [ ] Phase 10: 다이얼로그 변환
- [ ] Phase 11: 리소스 및 아이콘
- [ ] Phase 12: 빌드 및 테스트
- [ ] Phase 13: 배포 스크립트 작성

---

## ?? 다음 단계

**자동 변환 스크립트를 실행하시겠습니까?**

1. 폴더 생성
2. 클래스 파일 복사
3. 리소스 복사
4. 기본 XAML 생성

→ 명령어: "다음 단계 실행" 또는 "자동 변환 시작"
